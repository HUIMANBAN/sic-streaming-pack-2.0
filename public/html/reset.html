<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>重置用户</title>
    <!--    <link rel="icon" href="../image/title-logo/login.png" type="image/x-icon">-->
    <link rel="stylesheet" href="../css/reset.css" type="text/css">
</head>
<body>

<div class="reset-wrapper">
    <div class="header"><img id="sic-logo" src="../image/title-logo/sic-logo.png" alt=""></div>
    <div class="form-wrapper">
        <div id="div1">
            <label>
                <input type="text" name="SIC" class="input-item" id="SICInput"
                       placeholder="请输入SIC中文全称，不能带有空格哦~" value="">
            </label>
            <div class="btn" id="SICBtn">
                确认
            </div>
        </div>
        <div id="div2" style="display: none">
            <label>
                <input type="text" name="username" placeholder="请输入新用户名"
                       class="input-item" id="username">
            </label>
            <label>
                <input type="text" name="password" placeholder="请输入新密码" class="input-item" id="password">
            </label>
            <div class="btn" id="userBtn">
                确认
            </div>
        </div>

    </div>
</div>

<!--底部信息-->
<!--<div id="info">-->
<!--    程序原创：黄浩泓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-->
<!--    美术指导：刘梦云、 马世龙&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-->
<!--    程序重构：许文彬-->
<!--</div>-->

<!--导入axios框架-->
<script src="../library/axios.js"></script>

<script>
    //logo旋转
    const sic_logo = document.querySelector('#sic-logo');
    const login_wrapper = document.querySelector('.reset-wrapper');
    let currentRotation = 0;
    login_wrapper.addEventListener('mouseenter', function () {
        currentRotation += 360;  // 每次鼠标进入时增加 360 度
        sic_logo.style.transform = `rotate(${currentRotation}deg)`;
    });

    const SICBtn = document.querySelector('#SICBtn');
    const div1 = document.querySelector('#div1');
    const div2 = document.querySelector('#div2');

    function checkSICName() {
        const SICInput = document.getElementById('SICInput').value;
        if (SICInput === '校学生信息网络中心') {
            div1.style.display = 'none';
            div2.style.display = 'block';
        } else if (SICInput !== '校学生信息网络中心') {
            count++;
            if (count === 1) {
                alert('你干嘛，诶呦\nSIC的全称都忘记了？(•́へ•́ ╬)');
            } else if (count === 2) {
                alert('算了，劳资直接告诉你吧╮(╯▽╰)╭，照着写会吧\n校学生信息网络中心');
            } else if (count === 3) {
                alert('刚刚不是告诉你了吗？o(一︿一+)o\n校学生信息网络中心');
            } else {
                alert('你干嘛，诶哟，是不是香翅捞饭是不是');
            }
        }
    }

    let count = 0;
    SICBtn.addEventListener('click', function () {
        checkSICName();
    });

    function submit() {
        const theName = document.querySelector('#username').value;
        const thePass = document.querySelector('#password').value;
        if (theName === '' || thePass === '') {
            alert('用户名和密码不能为空');
        } else {
            axios({
                method: 'post',
                url: '/resetUser',
                data: {
                    newName: theName,
                    newPass: thePass
                }
            }).then(
                window.location.href = '/'
            );
            alert(`请记住你的用户名和密码\n用户名：${theName}\n密码：${thePass}\n然后请重新登入`);
        }
    }

    //重置按钮提交数据
    const userBtn = document.querySelector('#userBtn');
    userBtn.addEventListener('click', function () {
        submit();
    });

    document.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
            if (div2.style.display === 'none') {
                checkSICName();
            } else {
                submit();
            }
        }
    });
</script>
<script src="../js/refresh.js"></script>
</body>
</html>